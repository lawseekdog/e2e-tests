# 民事上诉场景 - 被上诉人（一审胜诉）

## 场景概述

本场景模拟被上诉人（一审胜诉方）应对对方上诉的完整流程。被上诉人需要针对上诉人的上诉理由进行答辩，维护一审判决结果。

## 案件背景

- **案由**：民间借贷纠纷
- **一审判决**：判决被告张三E2E01返还原告王五E2E01借款本金100000元及利息
- **上诉人**：张三E2E01（一审被告）
- **被上诉人**：王五E2E01（一审原告）
- **上诉理由**：认为借款事实不存在，一审判决认定事实错误
- **答辩策略**：维持原判，证明一审判决认定事实清楚、证据充分

## 目录结构

```
litigation_civil_appeal_appellee/
├── config.yaml                    # 场景配置文件
├── browser_steps.yaml             # 浏览器操作步骤
├── paths/                         # 对话路径
│   ├── progressive.yaml           # 渐进式对话（6轮交互）
│   ├── one_shot.yaml              # 一次性完整输入（5轮交互）
│   └── rollback.yaml              # 回退补充场景（8轮交互）
├── assets/                        # 测试数据文件
│   ├── appeal_petition.txt        # 对方上诉状
│   ├── first_instance_judgment.txt # 一审判决书
│   ├── defense_grounds.txt        # 答辩理由
│   └── additional_evidence.txt    # 补充证据
├── docs/                          # 文档和截图
│   └── verification.png           # 验证截图
└── README.md                      # 本文件
```

## 对话路径说明

### 1. progressive.yaml - 渐进式对话（6轮交互）

适用于被上诉人信息不完整的场景，需要逐步补充信息。

**交互流程**：
1. **R1**: 用户描述对方上诉情况 + 上传上诉状和一审判决书 → AI 返回 clarify 卡片（补充当事人信息）
2. **R2**: 用户补充被上诉人和上诉人身份证号 → AI 返回 select 卡片（案由确认）
3. **R3**: 用户确认案由 → AI 返回 select 卡片（答辩策略选择）
4. **R4**: 用户选择答辩策略（维持原判） → AI 返回 select 卡片（文书选择）
5. **R5**: 用户选择文书类型（上诉答辩状） → AI 返回 confirm 卡片（文书审核）
6. **R6**: 用户确认文书 → 完成，生成上诉答辩状

### 2. one_shot.yaml - 一次性完整输入（5轮交互）

适用于被上诉人信息完整的场景，跳过 clarify 环节。

**交互流程**：
1. **R1**: 用户一次性提供完整信息（包括身份证号）+ 上传所有证据 → AI 返回 select 卡片（案由确认）
2. **R2**: 用户确认案由 → AI 返回 select 卡片（答辩策略选择）
3. **R3**: 用户选择答辩策略 → AI 返回 select 卡片（文书选择）
4. **R4**: 用户选择文书类型 → AI 返回 confirm 卡片（文书审核）
5. **R5**: 用户确认文书 → 完成，生成上诉答辩状

### 3. rollback.yaml - 回退补充场景（8轮交互）

适用于在文书确认环节发现问题，需要补充答辩理由或证据的场景。

**交互流程**：
1. **R1-R4**: 同 progressive 的前4轮
2. **R5**: 用户选择文书类型 → AI 返回 confirm 卡片
3. **R6**: 用户确认文书时发现问题，提供反馈 → AI 触发 clarify 卡片（补充答辩理由）
4. **R7**: 用户补充详细答辩理由 + 上传补充证据 → AI 重新生成文书，返回 confirm 卡片
5. **R8**: 用户确认最终文书 → 完成，生成上诉答辩状

## 涉及的 Skill

- **litigation-intake**: 案件信息收集和整理
- **cause-recommendation**: 案由推荐和确认
- **documents**: 文书类型选择
- **document-generation**: 文书生成

## 产物

- **appeal_defense**: 上诉答辩状（.docx 格式）

## 测试数据说明

### appeal_petition.txt
对方（上诉人张三E2E01）的上诉状，主要上诉理由：
- 认为借款事实不存在
- 借条非本人书写
- 转账系归还此前欠款
- 一审判决认定事实错误

### first_instance_judgment.txt
一审判决书，判决内容：
- 判决被告张三E2E01返还原告王五E2E01借款本金100000元
- 支付逾期利息（按年利率6%计算）
- 案件受理费由被告承担

### defense_grounds.txt
被上诉人的答辩理由补充说明，主要内容：
- 借条真实性的论证
- 转账记录的证明力
- 聊天记录的证明作用
- 证据链的完整性
- 一审判决的正确性

### additional_evidence.txt
补充证据清单，包括：
- 借条原件
- 银行转账记录
- 微信聊天记录
- 通话录音
- 证人证言
- 被告其他借款记录（用于笔迹比对）

## 运行测试

```bash
pytest tests/test_litigation_civil_appeal_appellee.py -v
```

## 验证要点

1. **信息收集完整性**：系统能否正确收集被上诉人信息、上诉人信息、上诉理由等
2. **案由识别准确性**：系统能否正确识别民间借贷纠纷案由
3. **答辩策略合理性**：系统能否提供合理的答辩策略选项（维持原判、部分支持等）
4. **文书生成质量**：生成的上诉答辩状是否包含必要的答辩理由和证据分析
5. **回退机制有效性**：在发现问题时能否正确触发回退，补充信息后重新生成文书

## 注意事项

1. 本场景中被上诉人是一审胜诉方，答辩目标是维持原判
2. 需要针对上诉人的每一条上诉理由进行有针对性的答辩
3. 答辩状应当充分论证一审判决的正确性，包括事实认定和法律适用
4. 证据链的完整性是答辩的关键，需要证明借条、转账记录、聊天记录等证据相互印证
5. 测试数据中的身份证号、联系方式等均为虚构，仅用于测试
